<!DOCTYPE html>
<html lang="zh_cn">
<head>
    <meta charset="utf-8">
    <title>Heriam - 使用Pelican在Github(国外)和Coding(国内)同步托管博客</title>
    <meta name="description" content="">
    <meta name="author" content="Justin Time">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="baidu-site-verification" content="OGeiccsh1O" />
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="../../theme/html5.js"></script>
    <![endif]-->
	<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://cdn.bootcss.com/normalize/8.0.1/normalize.min.css" rel="stylesheet">
    <script src="../../tipuesearch_content.js"></script>
    <link rel="stylesheet" href="../../theme/tipuesearch/tipuesearch.css">
    <script src="../../theme/tipuesearch/tipuesearch_set.js"></script>
    <script src="../../theme/tipuesearch/tipuesearch.min.js"></script>
	<script src="../../theme/bootstrap-collapse.js"></script>
	<script>
		(function(){
			var bp = document.createElement('script');
			var curProtocol = window.location.protocol.split(':')[0];
			if (curProtocol === 'https') {
				bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
			}
			else {
				bp.src = 'http://push.zhanzhang.baidu.com/push.js';
			}
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(bp, s);
		})();
	</script>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8958123988900703",
        enable_page_level_ads: true
      });
    </script>
    <script>
        function validateForm(query)
        {
            return (query.length > 0);
        }
    </script>

    <!-- Le styles -->
    <link href="../../theme/bootstrap.min.css" rel="stylesheet">
    <link href="../../theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="../../theme/local.css" rel="stylesheet">
    <link href="../../theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>
<a href="javascript:void(0);" id="scroll" title="Scroll to Top" style="display: none;">Top<span></span></a>
<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="../..">Heriam</a>

        <div class="nav-collapse">
        <ul class="nav">
            <li class="dropdown-jh"><a>Categories</a>
                <ul class="dropdown-content-jh">
                    <li><a href="../../categories/blog.html">Blog</a></li>
                    <li><a href="../../categories/coding.html">Coding</a></li>
                    <li><a href="../../categories/notes.html">Notes</a></li>
                    <li><a href="../../categories/tools.html">Tools</a></li>
                </ul>
            </li>

            <li><a href="/articles">Archives</a></li>
            <li><a href="/tags">Tags</a></li>
            <li><a href="/pages/publications">Publications</a></li>
            
        </ul>

        <form class="navbar-search pull-right" action="/pages/search.html" onsubmit="return validateForm(this.elements['q'].value);">
            <div class="tipue_search_group">
            <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input">
        </form>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>使用Pelican在Github(国外)和Coding(国内)同步托管博客</h1>
<span class="metadata">
2018-02-05 Mon&nbsp;&nbsp;&nbsp;

by <a class="url fn" href="../../authors/justin-time.html">Justin Time</a>&nbsp;&nbsp;&nbsp;
 

Category: <a href="../../categories/blog.html">Blog</a>&nbsp;&nbsp;&nbsp;

 
 
    Tags: <a href="../../tags/pelican.html">Pelican</a>,&nbsp;<a href="../../tags/git.html">Git</a>,&nbsp;</span>        </div>
		
		<br />
		<hr />
		
        <div><p><strong>介绍：</strong> Github Pages 禁用了百度爬虫，因此百度搜索引擎经常抓取不到在Github上托管的博客链接。本文介绍一种可行的解决方法：   <br>
- 注册Coding用来托管一份和Github上一样的博客仓库专门服务国内的索引  <br>
- 配置<span class="caps">DNS</span>解析，将国内的线路解析到Coding，国外的线路解析到Github  <br>
- 配置Pelican，支持一键将同一份本地博客仓库同时发布到Github和Coding
  ​        <br>
  <br>   </p>
<hr>
<p><strong>一、</strong><a href="http://www.jianshu.com/p/fd8ed9855f44">《Pelican＋Github博客搭建详细教程》</a>      </p>
<hr>
<p>按照标题链接给出的教程先搭建出一个基于Github托管的博客系统。接下来将说明如何将博客同步到Coding。  <br>
<br>   </p>
<hr>
<p><strong>二、在Coding创建一个新的项目</strong></p>
<hr>
<ol>
<li>在<a href="http://www.coding.net">Coding首页</a>进行注册并登陆，创建项目的方法与Github类似，不同之处在于coding新建的公开项目名和用户名相同，而不像Github那样是&lt;用户名&gt;.github.io。创建完成后，生成的新的项目链接应该类似于：<code>https://coding.net/&lt;usrname&gt;/&lt;username&gt;.git</code>。  <br>
  <br>   </li>
<li>将本地<span class="caps">SSH</span>公钥拷贝到coding。操作同样与Github类似。由于本地已经为Github生成了一个公钥，这里只用cd进入~/.ssh文件夹查看一个名为<code>id_rsa.pub</code>文件的内容，类似于如下。我们只拷贝<strong>邮箱之前</strong>的所有内容到coding的公钥管理页面。     </li>
</ol>
<div class="highlight"><pre><span></span>ssh-rsa AAAAfafjIJGOF+FDA。。(省略)。。Ksap Heriam@users.noreply.github.com
</pre></div>


<p><br>   </p>
<hr>
<p><strong>三、将仓库拷贝到Coding</strong></p>
<hr>
<ol>
<li>进入Pelican的output目录下的本地博客仓库，打开.git/config，修改远程仓库，将 origin 改为 github，并添加&nbsp;coding：   </li>
</ol>
<div class="highlight"><pre><span></span><span class="k">[core]</span>
        <span class="na">repositoryformatversion</span> <span class="o">=</span> <span class="s">0</span>
<span class="s">        filemode = true</span>
<span class="s">        bare = false</span>
<span class="s">        logallrefupdates = true</span>
<span class="s">        ignorecase = true</span>
<span class="s">        precomposeunicode = true</span>
<span class="k">[remote &quot;github&quot;]</span>
        <span class="na">url</span> <span class="o">=</span> <span class="s">git@github.com:Heriam/heriam.github.io.git</span>
<span class="s">        fetch = +refs/heads/*:refs/remotes/github/*</span>
<span class="k">[remote &quot;coding&quot;]</span>
        <span class="na">url</span> <span class="o">=</span> <span class="s">git@git.coding.net:Heriam/heriam.git</span>
<span class="s">        fetch = +refs/heads/*:refs/remotes/coding/*</span>
<span class="k">[branch &quot;master&quot;]</span>
        <span class="na">remote</span> <span class="o">=</span> <span class="s">origin</span>
<span class="s">        merge = refs/heads/master</span>
</pre></div>


<p><br>  <br>
2. 然后将仓库 push 到 Coding上，在Coding新建一个 coding-pages&nbsp;分支：    </p>
<div class="highlight"><pre><span></span>git push -u coding master:coding-pages
</pre></div>


<p><br>  <br>
3. 这时登录Coding就可以看到博客内容已经被拷贝到coding-pages分支。
  <br>   </p>
<hr>
<p><strong>四、配置域名</strong></p>
<hr>
<ol>
<li>登录到网站的域名解析管理页面（我用的是<span class="caps">DNSPOD</span>，后来转向Cloudxns），然后添加两条域名解析记录：</li>
</ol>
<div class="highlight"><pre><span></span>@       CNAME  国内  coding.me
www     CNAME  国内  coding.me
</pre></div>


<p><br>   </p>
<ol>
<li>在Coding 上“项目管理”中找到“自定义域名／Pages”，添加要绑定的域名，比如我是&nbsp;hao-jiang.com和www.hao-jiang.com。注意这些域名也就是我们刚刚在dnspod中设置的解析域名。</li>
</ol>
<p><br>   </p>
<hr>
<p><strong>五、配置Pelican实现同步提交</strong></p>
<hr>
<p>设置一键上传：（如有疑问参见<a href="http://www.jianshu.com/p/fd8ed9855f44">《Pelican＋Github博客搭建详细教程》</a>第三部分第4点）打开根目录下的Makefile文件，修改以下三个地方： <br>
<br>  <br>
- <span class="caps">OUTPUTDIR</span>        </p>
<div class="highlight"><pre><span></span><span class="nv">OUTPUTDIR</span><span class="o">=</span><span class="k">$(</span>BASEDIR<span class="k">)</span>/output/&lt;username&gt;.github.io    <span class="c1">#本地博客仓库路径</span>
</pre></div>


<p><br> <br>
-&nbsp;publish    </p>
<div class="highlight"><pre><span></span><span class="nf">publish</span><span class="o">:</span>    
 <span class="k">$(</span>PELICAN<span class="k">)</span> <span class="k">$(</span>INPUTDIR<span class="k">)</span> -o <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> -s <span class="k">$(</span>CONFFILE<span class="k">)</span> <span class="k">$(</span>PELICANOPTS<span class="k">)</span>    
</pre></div>


<p><br> <br>
- github:&nbsp;publish</p>
<div class="highlight"><pre><span></span><span class="n">github</span><span class="o">:</span> <span class="n">publish</span>
    <span class="n">cd</span> <span class="n">$</span><span class="o">(</span><span class="n">OUTPUTDIR</span><span class="o">)</span> <span class="o">;</span> <span class="n">git</span> <span class="n">add</span> <span class="o">.</span> <span class="o">;</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">am</span> <span class="s1">&#39;&lt;添加自己的备注&gt;&#39;</span> <span class="o">;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">github</span> <span class="n">master</span><span class="o">:</span><span class="n">master</span> <span class="o">;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">coding</span> <span class="n">master</span><span class="o">:</span><span class="n">coding</span><span class="o">-</span><span class="n">pages</span> 
</pre></div>


<p><br>
这样 ，通过<code>make github</code>命令就能一键发布博客更新到Github和Coding了。</p></div>
	
        <hr>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
	var gitalk = new Gitalk({
		clientID: 'da84a60f2d38accc2888',
		clientSecret: '41ee3ed1d0800f3cbd44bfa58d3462aefc3d42e7',
		repo: 'heriam.github.io',
		owner: 'Heriam',
		admin: ['Heriam'],
		id: md5(window.location.pathname),      // Ensure uniqueness and length less than 50
		distractionFreeMode: false  // Facebook-like distraction free mode
	})

	gitalk.render('gitalk-container')
</script>    </div>
        </div>
        
        <div class="span3">
		
		    <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
    			<div style="width:80%; margin:0 auto;">
                    <div style="text-align: center;">
						<a href="/" class="profilepic">
                            <img src="https://i.loli.net/2019/03/31/5ca03b154a620.png" alt="photo-zzz.png" title="photo-zzz.png" />
						</a>
						<h1><span class="mainTitle">Hao Jiang</span><span class="subTitle">Justin Time</span></h1>
						<p class="motto">We only live once, and time just goes by.</p>
						<ul class="biography">
						<li><span><img src="../../theme/images/icons/work.svg" class="listIcon"></span><span>R&amp;D Engineer <a href="http://www.h3c.com" target="_blank">@H3C</a></span></li>
						<li><span><img src="../../theme/images/icons/location.svg" class="listIcon"></span><span>Hangzhou, China</span></li>

					<hr>

						<div class="tooltip">
							<span class="tooltiptext">Facebook</span>
							<a href="https://www.facebook.com/hao.zju" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/Facebook.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">微博</span>
							<a href="http://weibo.com/207575725" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/微博.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Linkedin</span>
							<a href="http://www.linkedin.com/in/haochiang" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/Linkedin.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Github</span>
							<a href="https://github.com/Heriam" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/Github.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Email</span>
							<a href="mailto:jiang.haoa@h3c.com" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/Email.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Instagram</span>
							<a href="https://www.instagram.com/heriam_j/" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/Instagram.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">ResearchGate</span>
							<a href="https://www.researchgate.net/profile/Hao_Jiang59" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/ResearchGate.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">知乎</span>
							<a href="https://www.zhihu.com/people/justin-time" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/知乎.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">OSChina</span>
							<a href="https://my.oschina.net/u/4108498" target="_blank" class="socialLink" style="background: url(../../theme/images/icons/OSChina.svg) center no-repeat"></a>
						</div>
					</div>
                </div>
            </div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="../..">Heriam</a> &copy; Justin Time 2019</p>
</footer>

</div> <!-- /container -->
<script>var _gaq=[['_setAccount','UA-137721527-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
 
</body>
</html>