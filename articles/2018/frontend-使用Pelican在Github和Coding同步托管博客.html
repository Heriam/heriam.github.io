<!DOCTYPE html>
<html lang="zh_cn">
<head>
    <meta charset="utf-8">
    <title>Heriam - 使用Pelican在Github(国外)和Coding(国内)同步托管博客</title>
    <meta name="description" content="">
    <meta name="author" content="Justin Time">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="baidu-site-verification" content="OGeiccsh1O" />
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://jiang-hao.com/theme/html5.js"></script>
    <![endif]-->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
	<script async src="https://cdnjs.cloudflare.com/ajax/libs/echarts/4.2.1/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
    <script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script>

    <script src="https://jiang-hao.com/tipuesearch_content.js"></script>
    <link rel="stylesheet" href="https://jiang-hao.com/theme/tipuesearch/tipuesearch.css">
    <script src="https://jiang-hao.com/theme/tipuesearch/tipuesearch_set.js"></script>
    <script src="https://jiang-hao.com/theme/tipuesearch/tipuesearch.min.js"></script>
	<script src="https://jiang-hao.com/theme/bootstrap-collapse.js"></script>

    <!-- Le styles -->
    <link href="https://jiang-hao.com/theme/bootstrap.min.css" rel="stylesheet">
    <link href="https://jiang-hao.com/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="https://jiang-hao.com/theme/local.css" rel="stylesheet">
    <link href="https://jiang-hao.com/theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>
<a href="javascript:void(0);" id="scroll" title="Scroll to Top" style="display: none;">Top<span></span></a>
<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="https://jiang-hao.com">Heriam</a>

        <div class="nav-collapse">
        <ul class="nav">
            <li class="dropdown-jh"><a>Categories</a>
                <ul class="dropdown-content-jh">
                    <li><a href="https://jiang-hao.com/categories/algorithms.html">Algorithms</a></li>
                    <li><a href="https://jiang-hao.com/categories/backend.html">Backend</a></li>
                    <li><a href="https://jiang-hao.com/categories/big-data.html">Big Data</a></li>
                    <li><a href="https://jiang-hao.com/categories/cloud.html">Cloud</a></li>
                    <li><a href="https://jiang-hao.com/categories/frontend.html">Frontend</a></li>
                    <li><a href="https://jiang-hao.com/categories/networking.html">Networking</a></li>
                    <li><a href="https://jiang-hao.com/categories/notes.html">Notes</a></li>
                    <li><a href="https://jiang-hao.com/categories/tools.html">Tools</a></li>
                </ul>
            </li>

            <li><a href="/articles">Archives</a></li>
            <li><a href="/tags">Tags</a></li>
            <li><a href="/pages/publications">Publications</a></li>
            <li><a href="/pages/aboutme">AboutMe</a></li>
            
        </ul>

        <form class="navbar-search pull-right" action="https://jiang-hao.com/search.html" onsubmit="return validateForm(this.elements['q'].value);">
            <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input">
        </form>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>使用Pelican在Github(国外)和Coding(国内)同步托管博客</h1>
<span class="metadata">
2018-02-05 Mon&nbsp;&nbsp;&nbsp;

by <a class="url fn" href="https://jiang-hao.com/authors/justin-time.html">Justin Time</a>&nbsp;&nbsp;&nbsp;
 

Category: <a href="https://jiang-hao.com/categories/frontend.html">Frontend</a>&nbsp;&nbsp;&nbsp;

 
 
    Tags: <a href="https://jiang-hao.com/tags/pelican.html">Pelican</a>,&nbsp;<a href="https://jiang-hao.com/tags/git.html">Git</a>,&nbsp;</span>        </div>

		<hr />


        <div><p><strong>介绍：</strong> Github Pages 禁用了百度爬虫，因此百度搜索引擎经常抓取不到在Github上托管的博客链接。本文介绍一种可行的解决方法：   <br>
- 注册Coding用来托管一份和Github上一样的博客仓库专门服务国内的索引  <br>
- 配置DNS解析，将国内的线路解析到Coding，国外的线路解析到Github  <br>
- 配置Pelican，支持一键将同一份本地博客仓库同时发布到Github和Coding
  ​        <br>
  <br>   </p>
<hr>
<p><strong>一、</strong><a href="https://jiang-hao.com/articles/2018/frontend-%E4%BD%BF%E7%94%A8Pelican%E5%9F%BA%E4%BA%8EGithubPages%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%95%99%E7%A8%8B.html">《Pelican＋Github博客搭建详细教程》</a>      </p>
<hr>
<p>按照标题链接给出的教程先搭建出一个基于Github托管的博客系统。接下来将说明如何将博客同步到Coding。  <br>
<br>   </p>
<hr>
<p><strong>二、在Coding创建一个新的项目</strong></p>
<hr>
<ol>
<li>在<a href="http://www.coding.net">Coding首页</a>进行注册并登陆，创建项目的方法与Github类似，不同之处在于coding新建的公开项目名和用户名相同，而不像Github那样是&lt;用户名&gt;.github.io。创建完成后，生成的新的项目链接应该类似于：<code>https://coding.net/&lt;usrname&gt;/&lt;username&gt;.git</code>。  <br>
    <br>   </li>
<li>将本地SSH公钥拷贝到coding。操作同样与Github类似。由于本地已经为Github生成了一个公钥，这里只用cd进入~/.ssh文件夹查看一个名为<code>id_rsa.pub</code>文件的内容，类似于如下。我们只拷贝<strong>邮箱之前</strong>的所有内容到coding的公钥管理页面。     </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="err">ssh-rsa AAAAfafjIJGOF+FDA。。(省略)。。Ksap Heriam@users.noreply.github.com</span>
</code></pre></div>

<p><br>   </p>
<hr>
<p><strong>三、将仓库拷贝到Coding</strong></p>
<hr>
<ol>
<li>进入Pelican的output目录下的本地博客仓库，打开.git/config，修改远程仓库，将 origin 改为 github，并添加 coding：   </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">[core]</span>
        <span class="na">repositoryformatversion</span> <span class="o">=</span> <span class="s">0</span>
<span class="s">        filemode = true</span>
<span class="s">        bare = false</span>
<span class="s">        logallrefupdates = true</span>
<span class="s">        ignorecase = true</span>
<span class="s">        precomposeunicode = true</span>
<span class="k">[remote &quot;github&quot;]</span>
        <span class="na">url</span> <span class="o">=</span> <span class="s">git@github.com:Heriam/heriam.github.io.git</span>
<span class="s">        fetch = +refs/heads/*:refs/remotes/github/*</span>
<span class="k">[remote &quot;coding&quot;]</span>
        <span class="na">url</span> <span class="o">=</span> <span class="s">git@git.coding.net:Heriam/heriam.git</span>
<span class="s">        fetch = +refs/heads/*:refs/remotes/coding/*</span>
<span class="k">[branch &quot;master&quot;]</span>
        <span class="na">remote</span> <span class="o">=</span> <span class="s">origin</span>
<span class="s">        merge = refs/heads/master</span>
</code></pre></div>

<p><br>  <br>
2. 然后将仓库 push 到 Coding上，在Coding新建一个 coding-pages 分支：    </p>
<div class="highlight"><pre><span></span><code><span class="err">git push -u coding master:coding-pages</span>
</code></pre></div>

<p><br>  <br>
3. 这时登录Coding就可以看到博客内容已经被拷贝到coding-pages分支。
    <br>   </p>
<hr>
<p><strong>四、配置域名</strong></p>
<hr>
<ol>
<li>登录到网站的域名解析管理页面（我用的是DNSPOD，后来转向Cloudxns），然后添加两条域名解析记录：</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="err">@       CNAME  国内  coding.me</span>
<span class="err">www     CNAME  国内  coding.me</span>
</code></pre></div>

<p><br>   </p>
<ol>
<li>在Coding 上“项目管理”中找到“自定义域名／Pages”，添加要绑定的域名，比如我是 <a href="https://jiang-hao.com">jiang-hao.com</a>和<a href="https://jiang-hao.com">www.jiang-hao.com</a>。注意这些域名也就是我们刚刚在dnspod中设置的解析域名。</li>
</ol>
<p><br>   </p>
<hr>
<p><strong>五、配置Pelican实现同步提交</strong></p>
<hr>
<p>设置一键上传：（如有疑问参见<a href="https://jiang-hao.com/articles/2018/frontend-%E4%BD%BF%E7%94%A8Pelican%E5%9F%BA%E4%BA%8EGithubPages%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%95%99%E7%A8%8B.html">《Pelican＋Github博客搭建详细教程》</a>第三部分第4点）打开根目录下的Makefile文件，修改以下三个地方： <br>
<br>    </p>
<ul>
<li>OUTPUTDIR        </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="err">OUTPUTDIR=$(BASEDIR)/output/&lt;username&gt;.github.io    #本地博客仓库路径</span>
</code></pre></div>

<p><br> <br>
-  publish    </p>
<div class="highlight"><pre><span></span><code><span class="c">publish:    </span>
<span class="c"> $(PELICAN) $(INPUTDIR) -o $(OUTPUTDIR) -s $(CONFFILE) $(PELICANOPTS)    </span>
</code></pre></div>

<p><br> <br>
- github: publish</p>
<div class="highlight"><pre><span></span><code><span class="n">github</span><span class="o">:</span> <span class="n">publish</span>
    <span class="n">cd</span> <span class="n">$</span><span class="o">(</span><span class="n">OUTPUTDIR</span><span class="o">)</span> <span class="o">;</span> <span class="n">git</span> <span class="n">add</span> <span class="o">.</span> <span class="o">;</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">am</span> <span class="s1">&#39;&lt;添加自己的备注&gt;&#39;</span> <span class="o">;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">github</span> <span class="n">master</span><span class="o">:</span><span class="n">master</span> <span class="o">;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">coding</span> <span class="n">master</span><span class="o">:</span><span class="n">coding</span><span class="o">-</span><span class="n">pages</span> 
</code></pre></div>

<p><br>
这样 ，通过<code>make github</code>命令就能一键发布博客更新到Github和Coding了。</p></div>
	
        <hr />

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
	var gitalk = new Gitalk({
		clientID: 'da84a60f2d38accc2888',
		clientSecret: '55fbc34a7e9fd0f956be286ed189fd4c4201f4f7',
		repo: 'heriam.github.io',
		owner: 'Heriam',
		admin: ['Heriam'],
		id: md5(window.location.pathname),      // Ensure uniqueness and length less than 50
		distractionFreeMode: false  // Facebook-like distraction free mode
	})

	gitalk.render('gitalk-container')
</script>    </div>
        </div>
        
        <div class="span3">
		
		    <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
    			<div style="width:80%; margin:0 auto;">
                    <div style="text-align: center;">
						<a href="/" class="profilepic">
                            <img src="https://i.loli.net/2019/10/31/TRSQt7aKkx6DdBA.png" οnerrοr="this.onerror=null;this.src='https://raw.githubusercontent.com/Heriam/images/master/portrait/photo-zzz.png';" alt="photo-zzz.png" title="photo-zzz.png" />
						</a>
						<h1><span class="mainTitle">Hao Jiang</span><span class="subTitle">Justin Time</span></h1>
						<p class="motto">We only live once, and time just goes by.</p>
						<ul class="biography">
						<li><span><img src="https://jiang-hao.com/theme/images/icons/work.svg" class="listIcon"></span><span>R&amp;D Engineer <a href="http://www.h3c.com" target="_blank">@H3C</a></span></li>
						<li><span><img src="https://jiang-hao.com/theme/images/icons/location.svg" class="listIcon"></span><span>Hangzhou, China</span></li>

					<hr>

						<div class="tooltip">
							<span class="tooltiptext">Facebook</span>
							<a href="https://www.facebook.com/hao.zju" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/Facebook.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">微博</span>
							<a href="http://weibo.com/207575725" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/微博.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Linkedin</span>
							<a href="http://www.linkedin.com/in/haochiang" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/Linkedin.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Github</span>
							<a href="https://github.com/Heriam" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/Github.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Email</span>
							<a href="mailto:jiang.haoa@h3c.com" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/Email.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">Instagram</span>
							<a href="https://www.instagram.com/heriam_j/" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/Instagram.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">ResearchGate</span>
							<a href="https://www.researchgate.net/profile/Hao_Jiang59" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/ResearchGate.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">知乎</span>
							<a href="https://www.zhihu.com/people/justin-time" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/知乎.svg) center no-repeat"></a>
						</div>
						<div class="tooltip">
							<span class="tooltiptext">OSChina</span>
							<a href="https://my.oschina.net/heriam" target="_blank" class="socialLink" style="background: url(https://jiang-hao.com/theme/images/icons/OSChina.svg) center no-repeat"></a>
						</div>
					</div>
                </div>
            </div>

	        <div class="well" style="padding: 0 0; background-color: #FBFBFB;">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-8185340840770803"
                     data-ad-slot="5123679766"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="https://jiang-hao.com">Heriam</a> &copy; Justin Time 2020.&nbsp;All rights reserved.</p>
</footer>

</div> <!-- /container -->
<script>var _gaq=[['_setAccount','UA-137721527-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
 
<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<script>
    function validateForm(query)
    {
        return (query.length > 0);
    }
</script>
<meting-js
    server="netease"
    type="playlist"
    id="43561591"
    fixed="true"
    order="list"
    volume="1.0"
    list-folded="true"
    >
</meting-js>
</body>
</html>